var JsOptions=(function(){var _options={};return function(key){if(_options[key]===undefined){_options[key]={};}
return{get:function(defaultOptions){if(typeof defaultOptions=='object'){_options[key]=Object.assign({},defaultOptions,_options[key]);}
return _options[key];},set:function(options){if(typeof options=='object'){for(var i in options){_options[key][i]=options[i];}}}};};})();function JsMergeOptions(base,options,force){options=Object.assign(base,options,force);var events={};for(var i in options){if(i.substring(0,2)=='on'&&typeof options[i]=='function'){events[i.substring(2).toLowerCase()]=options[i];delete options[i];}}
options.fire=function(name,scope,...args){if(events[name]){return events[name].apply(scope,...args);}}
return options;}
function Iterable(elements){if(!elements){return[];}else if(elements.nodeType==1){elements=[elements];}else{switch(Object.prototype.toString.call(elements).slice(8,-1)){case'Object':case'HTMLCollection':case'NodeList':let i=elements.length||0;let a=new Array(i);while(i--){a[i]=elements[i];}
elements=a;case'Array':break;default:return[];}}
return elements;}
var JsControls=function(controls){controls=Object.assign({},controls);return{attach:function(handle,name,fn){controls[handle][name]=fn;return this;},attachAll:function(handle,obj){if(typeof controls[handle]!='object'){controls[handle]={};}
for(let name in obj){controls[handle][name]=obj[name];}
return this;},load:function(handle,box,fn){let attr='control-'+handle;if(typeof fn!='function'){fn=function(el,fn,name){fn(el,name);};}
Array.from(box.querySelectorAll('['+attr+']')).forEach(function(el){let name=el.getAttribute(attr)||'default';if(controls[handle][name]){fn(el,controls[handle][name],name);}});return this;},};};var JsCookie=(function(){function set(key,value,attr){let cookie=key+'='+decodeURIComponent(value);attr=Object.assign({path:'/',expires:365},attr);if(typeof attr.expires==='number'){attr.expires=new Date(Date.now()+attr.expires*864e5);}
if(attr.expires){attr.expires=attr.expires.toUTCString();}
for(let name in attr){if(attr[name]){cookie+='; '+name;if(attr[name]!==true){cookie+='='+attr[name].split(';')[0];}}}
return(window.top.document.cookie=cookie);}
function get(key){let match=window.top.document.cookie.match(key+'=([^;]*)');if(!match){return'';}
let value=match[1];if(value[0]==='"'){value=value.slice(1,-1);}
return decodeURIComponent(value);}
return Object.create({set:set,get:get,remove:function(key,attr){set(key,'',Object.assign({},attr,{expires:-1}));}});})();const JsDropdown=(function(){let current;let that;return function(el,options){if(typeof el==='string'){el=document.querySelector(el);}
if(!el){if(that){that.hide();}
return;}
if(el==current){return that;}else if(that){that.hide();}
options=Object.assign({onToggle:null,onShow:null,onHide:null},options);current=el;that={show:function(){that.toggle(true);},hide:function(){that.toggle(false);},toggle:function(status){if(!current){return;}
if(typeof status=='undefined'){status=window.getComputedStyle(current)['display']=='none';}
function fn(evName,displayValue,fireEvents){document[evName]('click',that.hide);current[evName]('click',function(event){event.stopPropagation();});current.style.display=displayValue;fireEvents.forEach(function(fireEvent){if(typeof options[fireEvent]=='function'){options[fireEvent](status);}});}
if(status){fn('addEventListener','',['onToggle','onShow']);}else{fn('removeEventListener','none',['onToggle','onHide']);current=that=null;}}};return that;};})();JsDropdown.hide=function(){JsDropdown(false);};function JsElement(el,options){function setAttribute(attrName,attrValue){switch(attrName){case'styles':for(let j in attrValue){el.style[j]=attrValue[j];}
break;case'events':for(let j in attrValue){j.split(' ').forEach(function(eventName){el.addEventListener(eventName,attrValue[j]);});}
break;case'html':el.innerHTML=attrValue;break;case'text':el.textContent=attrValue;break;case'class':case'className':el.className=attrValue;break;case'multiple':el.multiple=attrValue;break;default:if(typeof attrValue=='function'){el[attrName]=attrValue;}else{el.setAttribute(attrName,attrValue);}
break;}}
function cleanTagName(tag){if(tag.indexOf('.')>-1){[tag,options.className]=tag.split('.');if(options.className.indexOf('#')>-1){[options.className,options.id]=tag.split('#');}}
if(tag.indexOf('#')>-1){[tag,options.id]=tag.split('#');}
return tag.toUpperCase();}
if(typeof options!='object'){options={};}
if(typeof el=='string'){el=document.createElement(cleanTagName(el));}
for(let i in options){setAttribute(i,options[i]);}
return el;}
var JsForm=function(form,options={}){if(typeof form=='object'&&form.tagName!='FORM'){options=form;form='';}
if(!form||typeof form=='number'){form=document.querySelector('#js-form'+(form||''));}else if(typeof form=='string'){try{form=document.querySelector(form)||document.querySelector('#'+form+'-form');}catch(e){}}
if(!form||form.tagName!='FORM'){return;}
options=Object.assign({focusable:true},options);var btn=options.btn;function focus(){function fn(types,checkables=[],tags=[]){for(let el,i=0;el=form.elements[i];i++){if(el.name&&!el.disabled){if(tags.includes(el.tagName)||types.includes(el.type)||(checkables.includes(el.type)&&el.checked)){return el;}}}}
let el=fn(['text','number','password','url','email','date'],['checkbox','radio'],['SELECT','TEXTAREA'])||fn(['submit'])||fn(['button']);if(el){el.focus();}}
var $U;var _data=[];var _controls=JsControls({form:{}});var that={url:function(fn){if(typeof fn=='function'){$U=fn;}
return this;},controls:function(options){for(var ctrlName in options){switch(typeof options[ctrlName]){case'object':options[ctrlName]=(function(options,ctrlName){var load=options.load||'xjs';if(typeof options.modalOptions=='object'&&load!='modal'){load='modal';}
if(!options.url&&$U){options.url=$U(ctrlName);}
return function(el){if(typeof options.onSubmit=='function'&&!options.onSubmit(el)){return;}
var data=[];var value=el.getAttribute('data-value');if(typeof value!='undefined'){data.push({[ctrlName]:value});}
switch(typeof options.data){case'function':case'string':case'object':data.push(options.data);break;}
JsRequest[load](Object.assign({},options,{data:data}));};})(options[ctrlName],ctrlName);case'function':_controls.attach('form',ctrlName,options[ctrlName]);break;}}
_controls.load('form',form,function(el,fn){var eventName='click';if(el.nodeName=='SELECT'||(el.type&&['checkbox','radio'].indexOf(el.type)!=-1)){eventName='change';}else if(el.nodeName=='INPUT'){eventName='blur';}
el.addEventListener(eventName,function(event){event.preventDefault();event.stopPropagation();document.body.click();fn(el);});});return this;},request:function(options,callback,load){switch(typeof options){case'function':this.submit=options;break;case'string':options={url:options};case'object':var options_data=options.data;var isArray=Array.isArray(options_data);if(typeof options.modalOptions=='object'){load='modal';}else if(typeof options.load!='undefined'&&typeof options.load){load=options.load;}else if(!load){load='xjs';}
if(typeof callback=='function'){options.onSuccess=callback;}
if(typeof options.onReset=='function'){form.addEventListener('reset',function(event){options.onReset.call(form,event);});}
this.submit=function(){if(typeof options.onSubmit=='function'&&!options.onSubmit(form)){return;}
if(typeof options.spinner=='undefined'){options.spinner={disable:this.getSubmit()};}
var data=this.getData();if(options_data){if(!Array.isArray(data)){data=[data];}
if(isArray){data.concat(options_data);}else{data.push(options_data);}}
options.data=data;JsRequest[load](options);};break;}
return this;},getData:function(){return _data.length?[form,_data]:form;},getForm:function(name){if(name){return typeof form[name]!='undefined'?form[name].value:undefined;}
return form;},getSubmit:function(){if(!btn){btn=form.querySelector('*[type=submit]');}
return btn;},reset:function(){form.reset();},notify:function(options){JsNotify.creator(form).notify(options);},};switch(typeof btn){case'object':if(btn.isModal){btn=btn.getSubmit();}
break;case'string':btn=document.querySelector(btn);break;}
if(btn){btn.setAttribute('form',form);if(!btn.form){btn.addEventListener('click',function(){that.submit();});}}
JsFelem.load(form,_data);JsControls({form:{'toggle-body':function(el){for(var box=el;!box.classList.contains('form-fieldset');box=box.parentNode){if(box.tagName=='BODY'){return;}}
el.addEventListener('click',function(){el.setAttribute('aria-expanded',box.classList.toggle('expanded'));});},}}).load('form',form);form.addEventListener('submit',function(event){event.preventDefault();that.submit();});if(options.focusable){focus();}
return that;};var JsHistory=function(stateKey,fn,stateValue){var
w=window.top,h=w.history,d=w.document,l=d.location,state=h.state||{};_value=stateValue!==undefined?stateValue:l.href;state[stateKey]=_value;h.replaceState(state,d.title,l.href);window.addEventListener('popstate',function(event){var v=event.state[stateKey];if(_value!=v){_value=v;fn(event);}});return{push:function(title,url,value){if(typeof value=='function'){value=value(h.state[stateKey]);}else if(!value){value=url;}
h.state[stateKey]=_value=value;h.pushState(h.state,title||'',url);},};};JsHistory.check=function(){return(history&&history.pushState);};let JsImport=(function(){let promises={};let head=document.querySelector('head');function i(resources){if(typeof resources==='string'){return resources.split(',').map(value=>value.trim());}
return resources?Array.isArray(resources):[];}
function getExtension(f){return f.substr(f.lastIndexOf('.')+1);}
function getElementPromise(tagName,attr,resource){return new Promise((resolve,reject)=>{let el=head.appendChild(document.createElement(tagName));el.onload=function(){promises[resource].complete=true;resolve();};el.onerror=function(){reject();};for(let attrName in attr){el[attrName]=attr[attrName];}});}
return function(resources){let All=[];i(resources).forEach(function(resource){if(typeof promises[resource]=='object'){All.push(promises[resource].complete?Promise.resolve():promises[resource].promise);}else{const extension=getExtension(resource);if(['js','css'].indexOf(extension)==-1){return;}
const promise=(extension==='js')?getElementPromise('script',{async:true,src:resource},resource):getElementPromise('link',{type:'text/css',rel:'stylesheet',href:resource},resource);All.push(promise);promises[resource]={complete:false,promise:promise};}});return Promise.all(All);};})();function Lightbox(options){options=Object.assign({iniVisible:true,hideWithButton:true,hideWithOverlay:true,valignCenter:true,},options);const body=document.body;const overlay=body.appendChild(JsElement('div.lightbox',{html:'<div></div>'}));const box=overlay.firstChild;const that={remnove:function(){overlay.parentNode.removeChild(overlay);body.classList.remove('lightbox-fixed');},toggle:function(force){const status=body.classList.toggle('lightbox-fixed',force);overlay.style.display=status?'':'none';return status;},show:function(){this.toggle(true);},hide:function(){this.toggle(false);},getContainer:function(){return box;},setContent:function(content){if(typeof content==='string'){box.innerHTML=content;}else{box.innerHTML='';box.appendChild(content);}
return this;}};if(options.valignCenter){overlay.classList.add('valign-center');}
if(options.hideWithButton){overlay.appendChild(JsElement('i.fa-solid fa-xmark lightbox-cross')).addEventListener('click',function(event){event.stopPropagation();that.hide();});}
if(options.hideWithOverlay){overlay.addEventListener('click',function(event){event.stopPropagation();that.hide();});box.addEventListener('click',function(event){event.stopPropagation();});}
that.toggle(options.iniVisible);return that;};function JsLoading(force){let ID='js-loading';let doc=window.self.document;(doc.getElementById(ID)||doc.body.appendChild(JsElement('div',{id:ID,className:ID}))).style.display=force?'':'none';};var JsMove=function(el,startFn,moveFn,endFn){function setClient(event){var e=event;switch(event.type){case'touchstart':e=event.touches[0];break;case'touchmove':case'touchend':e=event.changedTouches[0];break;}
if(e.clientX||e.clientY){if(e!==event){event.clientX=e.clientX;event.clientY=e.clientY;}}else if(e.pageX||e.pageY){event.clientX=e.pageX-document.body.scrollLeft-document.documentElement.scrollLeft;event.clientY=e.pageY-document.body.scrollTop-document.documentElement.scrollTop;}};function setEvent(el,eventNames,fn,force){eventNames.split(' ').forEach(function(eventName){el[(force?'add':'remove')+'EventListener'](eventName,fn);});};function activate(force){setEvent(document,'mousemove touchmove',_moveFn,force);setEvent(document,'mouseup touchend',_endFn,force);};function _startFn(event){setClient(event);startFn(event);activate(true);};function _moveFn(event){setClient(event);moveFn(event);};function _endFn(event){if(typeof endFn=='function'){setClient(event);endFn(event);}
activate(false);};setEvent(el,'mousedown touchstart',_startFn,true);};var JsNotify=(function(){var current;var notify=function(options){var handler;var _hits=0;function clear(){options.target.innerHTML='';current=null;}
function hit(){hide(1);}
function hide(hits,already){if(!(options.maxTime>0)){return;}
_hits+=hits;if(_hits>100){document.removeEventListener('click',hit);handler=clearTimeout(handler);if(already){clear();}else{handler=setTimeout(clear,1000);}}else if(_hits==100){handler=setTimeout(hit,options.maxTime*1000);}}
options=Object.assign({message:'',class:'',maxTime:42,minTime:8,target:null,},options);if(typeof options.target=='string'){options.target=document.querySelector(options.target);}
if(typeof options.target!='object'){alert(options.message);}
options.target.innerHTML='<span><span'
+(options['class']?' class="'+options['class']+'"':'')+'>'
+options.message
+'</span></span>';if(options.maxTime){document.addEventListener('click',hit);handler=setTimeout(function(){hide(100);},options.minTime*1000);}
return{hide:function(){hide(101,true);}};};return function(options){if(current!=null){current.hide();}
if(options){current=notify(options);}};})();JsNotify.hide=function(){JsNotify(false);};JsNotify.creator=function(object,before){if(typeof object.notify!='function'){if(!before){before=object;}
var _target=before.parentNode.insertBefore(JsElement('div.notify-box',{role:'alert'}),before);object.notify=function(options){if(typeof options=='string'){options={'message':options};}
options.target=_target;JsNotify(options);};}
return object;};var JsRequest=(function(){function getType(value){let type=typeof value;if(type=='object'){type=Object.prototype.toString.call(value).slice(8,-1);return(type.slice(0,4)=='HTML'?type.slice(4,-7):type).toLowerCase();}
return type;}
function toQueryArray(data,esc){let _data=[];switch(getType(data)){case'string':data.replace(/([^?=&]+)(=([^&]*))?/g,function($0,$1,$2,$3){_data.push([$1,$3]);});break;case'array':if(esc){data.forEach(function(item){_data.push(item);});}else{data.forEach(function(items){items=toQueryArray(items,true);if(items.length){Array.prototype.push.apply(_data,items);}});}
break;case'object':for(let i in data){_data.push([i,data[i]]);}
break;case'function':return toQueryArray(data());case'input':case'textarea':case'select':case'button':data={elements:[data]};case'form':let el;for(let i=0;el=data.elements[i];i++){if(el.name&&!el.disabled&&['file','reset'].indexOf(el.type)==-1){if(el.type=='select-multiple'){let m=el.options.length;for(let j=0;j<m;j++){if(el.options[j].selected){_data.push([el.name,el.options[j].value]);}}}else if(['checkbox','radio'].indexOf(el.type)==-1||el.checked){_data.push([el.name,el.value]);}}}
break;}
return _data;}
function toQueryString(data){data=toQueryArray(data);if(data){return data.map(function(a){return encodeURIComponent(a[0])+'='+encodeURIComponent(a[1])}).join('&').replace(/%20/g,'+');}
return'';}
function toFormData(data){if(getType(data)=='form'){return new FormData(data);}
let f,fd;if(getType(data)=='array'){for(let i=0,L=data.length;i<L&&!f&&!fd;i++){switch(getType(data[i])){case'form':f=data[i];data.splice(i,1);break;case'formdata':fd=data[i];data.splice(i,1);break;}}}
if(!fd){fd=new FormData(f);}
toQueryArray(data).forEach(function(dataItem){switch(dataItem.length){case 2:fd.append(dataItem[0],dataItem[1]);break;case 3:fd.append(dataItem[0],dataItem[1],dataItem[2]);break;}});return fd;}
function toURLGet(url,data){return url+(url.indexOf('?')==-1?'?':'&')+toQueryString(data);}
function parseUrlData(url){var data=[];if(url.indexOf('?')!=-1){var a=url.split('?')[1].split('&');for(var i in a){data.push(a[i].split('=').map(function(com){return decodeURIComponent(com);}));}}
return data;}
function onlineToast(){JsToast({message:'Online',type:'success'});}
function offlineToast(){JsToast({message:'Offline',type:'danger'});}
var online=window.navigator.onLine;var offline_displayed=false;window.addEventListener('offline',function(event){online=false;});window.addEventListener('online',function(event){online=true;if(offline_displayed){offline_displayed=false;onlineToast();}});return{mergeData:function(){let data=[];for(let i=0;i<arguments.length;i++){if(Array.isArray(arguments[i])){for(let j=0;j<arguments[i].length;j++){data.push(arguments[i][j]);}}else if(typeof arguments[i]!='undefined'){data.push(arguments[i]);}}
return data;},implement:function(obj){for(let i in obj){if(typeof obj[i]=='function'&&!this[i]){this[i]=obj[i];}}},load:function(options){let load=options.load||'text';if(['mergeData','implement','load'].indexOf(load)==-1&&typeof this[load]=='function'){this[load](options);}},link:function(options,forceOptions){options=Object.assign({},options,forceOptions);var el=document.body.appendChild(JsElement('a',{href:toURLGet(options.url,options.data),target:options.target||'_self',styles:{display:'none'}}));el.click();document.body.removeChild(el);},http:function(options,forceOptions){options=Object.assign({},options,forceOptions);var data=parseUrlData(options.url);if(getType(options.data)=='form'){var f=options.data;}else{var f=document.body.appendChild(JsElement('form'));data=data.concat(toQueryArray(options.data));}
data.forEach(function(d){f.appendChild(JsElement('input',{type:'hidden',name:d[0],value:d[1],}));});f.action=options.url;f.method=options.method;f.submit();if(typeof options.onSuccess=='function'){options.onSuccess();}},ajax:function(options,forceOptions){if(!online){if(!offline_displayed){offline_displayed=true;offlineToast();}}
options=Object.assign({},options,forceOptions);if(options.update){var el=options.update;delete options.update;options.onSuccess=function(html){if(typeof el=='string'){el=document.querySelector(el);}
el.innerHTML=html;};}
let data=getType(options.data)=='array'?options.data:[options.data];let fetchOptions={};if(options.spinner!==false){if(typeof spinner!='function'){options.spinner=JsLoading;}
options.spinner(true);}
if(typeof options.format!='undefined'){options.headers??={};if(options.responseType=='json'){options.headers['Accept']='application/json';}
options.url=toURLGet(options.url,{format:options.format});}
if(options.method=='GET'){options.url=toURLGet(options.url,data);}else{if(options.method&&options.method!='POST'){data.push({__method:options.method.toUpperCase()});}
fetchOptions.method='POST';fetchOptions.body=toFormData(data);}
['cache','credentials','headers','integrity','mode','redirect','referrer','referrerPolicy'].forEach(function(prop){if(typeof options[prop]!='undefined'){fetchOptions[prop]=options[prop];}});fetch(options.url,fetchOptions).then(function(response){if(options.spinner){options.spinner(false);}
return response[options.responseType]();}).then(function(data){switch(options.responseType){case'json':if(data.__error){throw new Error(data.__error);}
if(data.__alert){Modal(data.__alert);}
if(data.__profiler){JsConsole.log(data.__profiler);}
break;case'text':let log=JsConsole.getTextData(data);if(log){JsConsole.log(log);}
break;}
return data;}).then(function(data){if(typeof options.onSuccess=='function'){options.onSuccess.call(options,data);}}).catch(function(e){JsToast({message:`${e.name}: ${e.message}.`,type:'danger'});});},};})();JsRequest.implement({blank:function(options){return this.link(options,{target:'_blank'});},get:function(options){return this.http(options,{method:'GET'});},post:function(options){return this.http(options,{method:'POST'});},text:function(options){return this.ajax(options,{format:'text',responseType:'text',});},json:function(options){return this.ajax(options,{format:'json',responseType:'json',update:false,});},});var JsToast=(function(){var box;return function(options){if(typeof options=='string'){options={message:options};}
options=Object.assign({message:'',type:'',displayLength:8},options);if(!box){box=document.body.appendChild(JsElement('div.toast-container'));}
var toast=box.appendChild(JsElement('div',{html:'<div class="toast-body">'+options.message+'</div><div class="toast-close" data-toast="close"><i class="fa-solid fa-xmark"></i></div>',className:'toast'+(options.type?' toast-'+options.type:''),role:'alert',close:function(){box.removeChild(this);if(!box.firstChild){box.parentNode.removeChild(box);box=null;}
handler=false;}}));toast.querySelector('[data-toast=close]').addEventListener('click',function(){toast.close();});if(options.displayLength){var handler=setTimeout(function(){if(handler){toast.close();}},options.displayLength*1000)}
return toast;};})();const Tooltip=function(box){box=(box||document);const tt=(el)=>{let tooltip,parent,status;let content=el.getAttribute('data-value');if(content===null){content=el.title;el.title='';}
if(!content){return;}
if(content.charAt(0)=='#'){tooltip=box.querySelector(content);}
if(tooltip){for(parent=tooltip.parentNode;parent&&window.getComputedStyle(parent).position!='relative';parent=parent.parentNode==document.body?false:parent.parentNode);}else{tooltip=document.body.appendChild(JsElement('div.tooltip',{'html':content}));}
let position='top';let delay=0;el.getAttribute('data-tooltip').split(' ').forEach((cmd)=>{if(cmd=='blocked'){delay=100;}else if(['bottom','right','left'].indexOf(cmd)>-1){position=cmd;tooltip.classList.add(cmd);}});tooltip.toggle=function(force){switch(force){case 2:if(!status){status=1;}
case 1:if(status){return;}
status=1;break;case 0:status=0;if(delay){return setTimeout(()=>{tooltip.toggle(-1)},delay);}
break;case-1:if(status){return;}
case-2:force=0;break;}
if(force){let top,left;let rectA=el.getBoundingClientRect();let rectB=tooltip.getBoundingClientRect();let rectC=parent?parent.getBoundingClientRect():{top:-document.documentElement.scrollTop,left:-document.documentElement.scrollLeft};switch(position){case'top':top=(rectA.top-rectB.height-5);break;case'bottom':top=(rectA.top+rectA.height+5);break;case'right':left=(rectA.left+rectA.width+5);break;case'left':left=(rectA.left-rectB.width-5);break;}
if(!top){top=rectA.top+rectA.height/2-rectB.height/2;}else if(!left){left=rectA.left+rectA.width/2-rectB.width/2;}
tooltip.style.top=top-rectC.top+'px';tooltip.style.left=left-rectC.left+'px';TooltipActive.add(this);}
this.classList.toggle('show',force);};const events=(el,statuses)=>{statuses.forEach((status,i)=>{el.addEventListener(['mouseout','mouseover','focus','blur'][i],()=>{tooltip.toggle(status);});});}
events(el,[0,1,1,0]);if(delay){events(tooltip,[0,2]);}};Array.from(box.querySelectorAll('[data-tooltip]')).forEach(tt);};const TooltipActive=(function(){let current;return{add:function(el){this.hide();current=el;},hide:function(el){if(current){current.toggle(-2);}},};})();const JsFelem=(function(){const _observe={};const _felem={submit:function(el){el.addEventListener(el.getAttribute('data-value')||'click',function(){JsFelem.submit(el);});}};const that={implement:function(handles){for(let handle in handles){if(typeof handles[handle]=='function'){_felem[handle]=handles[handle];}}},observe:function(handles){for(let handle in handles){if(typeof handles[handle]=='function'){_observe[handle]=handles[handle];}}},load:function(box,data){if(!box){box=document;}else if(typeof box==='string'){box=document.querySelector(box);}
Array.from(box.querySelectorAll('*[control-felem]')).forEach(function(el){el.getAttribute('control-felem').split(' ').forEach(function(handle){if(handle&&typeof _felem[handle]=='function'){_felem[handle](el,box,data);}});});function observeFn(all,fn){all.forEach(function(el){fn(el,box,data);});}
for(let i in _observe){observeFn(Array.from(box.querySelectorAll(i)),_observe[i]);}},submit:function(form){for(;form.tagName!='FORM';form=form.parentNode){if(form.tagName=='BODY'){return;}}
let btn=form.querySelector('*[type="submit"]');if(btn){btn.click();}else{btn=form.appendChild(document.createElement('input'));btn.type='submit';btn.style.display='none';btn.click();form.removeChild(btn);}},};return that;})();JsFelem.implement({'check-all':function(checkall,form){const name=checkall.getAttribute('data-checkall');const elements=form.querySelectorAll('[name="'+name+'[]"]');function areAllChecked(){let i=elements.length
while(i--){if(!elements[i].checked){return false;}}
return true;}
function fn(){if(checkall.checked!=areAllChecked()){checkall.locked=true;checkall.parentNode.click();}}
checkall.addEventListener('change',function(){if(checkall.locked){checkall.locked=false;}else{elements.forEach(function(el){if(el.checked!=checkall.checked){el.locked=true;el.parentNode.click();}});}});elements.forEach(function(el){el.addEventListener('change',function(){if(el.locked){el.locked=false;}else{fn();}});});fn();}});function JsColor(el){if(el.tagName!='INPUT'){return;}
let btn=JsElement('input',{type:'color',value:el.value,className:'input-field input-color',events:{change:function(){el.value=btn.value;}}});el.type='text';el.addEventListener('input',function(){btn.value=el.value;});let group=el.parentNode.insertBefore(JsElement('div.input-group'),el);group.appendChild(el)
group.appendChild(btn);}
JsFelem.implement({'color':function(el,box){JsColor(el);}});(function(){function dropdown(el){let isSelect=el.getAttribute('control-felem')=='select';let hasSubmit=el.getAttribute('data-on-change')=='submit';let isSimple=el.className!='btn-group';let box=isSimple?el.parentNode:el;let btn=isSimple?el:(el.querySelector('[role=caret]')||el.querySelector('.dropdown-toggle'));let menu=(box.querySelector('[role=drop-menu]')||box.querySelector('.dropdown-menu'));function fn(event){event.stopPropagation();JsDropdown(menu,{onToggle:function(status){el.classList.toggle('active',status);btn.setAttribute('aria-expanded',status);if(status){let rect=menu.getBoundingClientRect();if(rect.right>window.innerWidth){menu.style.right='-1px';menu.style.left='auto';}else if(rect.left<0){menu.style.right='auto';menu.style.left='0px';}}},}).toggle();}
btn.addEventListener('click',fn);btn.setAttribute('aria-expanded',false);if(isSimple){menu.style.left=(el.getBoundingClientRect().left-el.parentNode.getBoundingClientRect().left)+'px';}else{menu.style.right='-1px';}
if(isSelect){let label=isSimple?el:el.querySelector('[data-select-label]');if(label){let hidden=menu.querySelector('input[type=hidden]');let all=Array.from(menu.getElementsByTagName('LI'));all.forEach(function(el){el.addEventListener('click',function(event){event.stopPropagation();all.forEach(function(el2){el2.className=(el2==el?'selected':'');});JsDropdown.hide();label.innerHTML=el.textContent;hidden.value=el.getAttribute('data-select-value');if(hasSubmit){JsFelem.submit(hidden.form);}});});}}};JsFelem.implement({'select':dropdown,'dropdown':dropdown});})();JsFelem.implement({password:function(el,box){if(el.tagName=='INPUT'){let btn=JsElement('div.btn',{html:'<i class="fa-solid fa-eye"></i>',events:{click:function(){let status=el.type=='password';el.type=status?'text':'password';btn.firstChild.className=status?'fa-solid fa-eye-slash':'fa-solid fa-eye';}}});let group=el.parentNode.insertBefore(JsElement('div.input-group'),el);group.appendChild(el)
group.appendChild(btn);}}});JsFelem.implement({'press':function(el,box){let input=el.querySelector('input');if(input){let all=(input.type=='radio')?Array.from(box.querySelectorAll('input[type=radio][name='+input.name+']')):[input];input.addEventListener('change',function(){all.forEach(function(el){el.parentNode.classList[el.checked?'add':'remove']('checked');});});}}});var FeTextarea={'max-chars':function(el){var max=el.getAttribute('data-max-chars');var div=el.parentNode.insertBefore(JsElement('div.color-light'),el.nextSibling);var fn=function(event){var total=max-el.value.length;if(total<0){event.preventDefault();el.value=el.value.substring(0,max);total='<span class="color-danger">0</span>';}
div.innerHTML=total;};if(max){el.addEventListener('keydown',fn);if('oninput'in el){el.addEventListener('input',fn);}
fn();}},'auto-grow':function(el){if('field-sizing'in document.body.style){return;}
const maxHeight=parseInt(el.getAttribute('data-max-height'));const minHeight=parseInt(el.getAttribute('data-min-height')||window.getComputedStyle(el).getPropertyValue('height'))||30;function fn(){el.style.height='0';el.style.height=Math.max(parseInt(maxHeight?Math.min(el.scrollHeight,maxHeight):el.scrollHeight),minHeight)+'px';}
el.style.overflow='hidden';el.style.wordWrap='break-word';el.style.resize='none';el.addEventListener('oninput'in el?'input':'keyup',fn);el.autoGrow=fn;fn();},};JsFelem.implement(FeTextarea);var Modal=function(options){options=JsMergeOptions({target:undefined,overlay:true,draggable:false,destroy:true,type:'default',size:'medium',title:'',icon:'',help_url:null,help_title:null,content:null,buttons:[],form:null,footer_html:'',},options);let controls=JsControls({modal:{close:function(){that.close()},hide:function(){that.hide()}},});let curFocus;let that={isModal:1,close:function(){if(element.parentNode){if(options.fire('close',that)===false){return that;}
toggleFix(false);that.blur();if(options.destroy){element.parentNode.removeChild(element);}else{that.hide();}}
return false;},show:function(){this.toggle(true);},hide:function(){this.toggle(false);},toggle:function(status){if(typeof status=='undefined'){status=element.style.display=='none';}
if(status){this.focus();}else{this.blur();}
element.style.display=status?'':'none';},focus:function(){if(!getFocusableElements().includes(document.activeElement)){curFocus=document.activeElement;}
options.target?.blur();element.querySelector('button[control-modal=close]')?.focus();if(options.overlay){element.scroll(0,0);}
document.addEventListener('keydown',keyboardControls);},blur:function(){options.target?.focus();curFocus?.focus();document.removeEventListener('keydown',keyboardControls);},getSubmit:function(){return element.querySelector('.modal-footer *[type=submit]');},getElement:function(selector){if(selector){return _element.querySelector(selector);}
return _element;}};function getFocusableElements(){return[..._element.querySelectorAll('a[href],button,input,textarea,select,details,[tabindex]:not([tabindex="-1"])')].filter(el=>!el.hasAttribute('disabled')&&!el.getAttribute('aria-hidden'));}
function keyboardControls(event){if(!element){that.blur();}
if(event.key=='Tab'){let focusables=getFocusableElements();let length=focusables.length;if(!length){event.preventDefault();}else if(!focusables.includes(document.activeElement)){event.preventDefault();focusables[0].focus();}else{let isBack=event.shiftKey;if(isBack){if(document.activeElement==focusables[0]){event.preventDefault();focusables[length-1].focus();}}else if(document.activeElement==focusables[length-1]){event.preventDefault();focusables[0].focus();}}}else if(event.key=='Escape'){that.close();}}
function getButtonClass(button){let css=['btn'];if(button.class){css.push(button.class);}
if(button.type=='submit'){css.push('btn-primary btn-solid');}
return css.join(' ');}
function render(number){let header='';let footer='';if(options.title){if(options.icon){header+='<div><i class="'+options.icon+'" aria-hidden="true"></i></div>';}
header+='<div id="modal-'+number+'-title" class="modal-title"><h3>'+options.title+'<h3></div>';if(options.help_url){header+='<div><a href="'+options.help_url+'" target="_blank" title="'+options.help_title+'"><i class="fa-solid fa-circle-question"></i></a></div>';}
header='<div class="modal-header">'+header+'</div>';}
if(options.buttons.length){let x={'help':'','button':'','submit':'','close':''};options.buttons.forEach(function(button){x[button.type]+='<button type="'+(button.type=='submit'?'submit':'button')+'"'
+(button.type!='submit'?' control-modal="'+(button.control||button.type)+'"':'')
+' class="'+getButtonClass(button)+'">'
+button.caption
+'</button>';});footer='<div class="modal-footer">'+options.footer_html+x.help+x.button+x.submit+x.close+'</div>';}
if(options.form){if(Array.isArray(options.form.hidden)){options.form.hidden.forEach(function(hidden){footer+='<input type="hidden" name="'+hidden.name+'" value="'+hidden.value+'"/>';});}
footer='<form id="'+options.form.id+'">'+footer+'</form>';}
return'<div class="modal modal-'+options.type+'" tabindex="-1" role="dialog" aria-modal="true" aria-labeledby="modal-'+number+'-title"><div>'
+header
+'<div class="modal-body">'+(options.content||'')+'</div>'
+footer
+'</div></div>';}
function toggleFix(force){if(options.overlay&&element.parentNode==document.body){if(Modal.countFixed==0||Modal.countFixed==1){document.body.classList.toggle('modal-fixed',force);document.body.style.width=force?document.body.clientWidth+'px':'';}
Modal.countFixed+=(force?1:-1);}}
if(options.type=='alert'){options.size='small';}
var _element=element=JsElement('div.modal-'+options.size,{html:render(Modal.countFixed),'data-modal':1,});if(options.draggable){let handle=element.querySelector('.modal-header');let initial;function startFn(event){event.stopPropagation();event.preventDefault();let rect=element.getBoundingClientRect();initial={x:rect.left-event.clientX,y:rect.top-event.clientY,};}
function moveFn(event){element.style.left=(initial.x+event.clientX)+'px';element.style.top=(initial.y+event.clientY)+'px';element.style.margin='0px';}
handle.style.cursor='move';JsMove(handle,startFn,moveFn);}else if(options.overlay){var element=JsElement('div.modal-overlay');element.appendChild(_element);element.addEventListener('click',that.close);_element.addEventListener('click',function(event){event.stopPropagation();JsDropdown.hide();});}
controls.load('modal',element,function(el,fn){el.addEventListener('click',fn);});let parent=document.body;if(typeof options.target=='object'){if(options.target.isModal){parent=options.target.getElement();}else{parent=options.target;}}
parent.appendChild(element);toggleFix(true);that.show();options.fire('load',that);JsNotify.hide();JsNotify.creator(that,element.querySelector('.modal-body'));return that;};Modal.countFixed=0;JsRequest.implement({modal:function(options){var mo=typeof options.modalOptions=='object'?options.modalOptions:null;return this.ajax(options,{format:'modal',responseType:'json',update:false,onSuccess:function(json){Modal(Object.assign({},mo,json));},});},});var JsConsole=(function(){function $U(args){return JsUrl('/profiler',args,'blank');}
var cookieName='JsConsole';var options={mode:0,};var _window;var _tails=[];function consolePopup(report){if(!_window||_window.closed){try{_window=window.open('','profiler-console','width=580,height=480,toolbar=no,scrollbars=no,top=500,left=500');if(_window.location=='about:blank'){_window.location=$U();}}catch(e){alert('The navigator lockout the popup! '+e);return;}}
if(typeof _window.JsConsole=='object'){_window.JsConsole.log(report);}else{_tails.push(report);}}
function consoleFrame(report){if(window.top==window.self){window.stop();window.location=$U({frame:window.location.href});}else{_window=window.parent;_window.JsConsole.log(report);_window.history.replaceState({path:window.self.location.href},window.self.document.title,window.self.location.href);}}
function setOption(key,value){options[key]=value;JsCookie.set(cookieName,JSON.stringify(options));}
return{getTails:function(){return _tails;},toggle:function(){setOption('mode',options.mode?0:1);(_window.opener||_window).location.reload();if(_window.opener){_window.close();}},log:function(report){if(typeof report!='object'){report={content:report,title:'Report'};}
switch(options.mode){case 1:consoleFrame(report);break;default:consolePopup(report);break;}},getTextData:function(html){var a=html.indexOf('<!--{profiler}');if(a>-1){var b=html.indexOf('-->',a);if(b){return html.slice(html.indexOf('}',a)+1,b);}}
return null;},load:function(e){var html=document.querySelector('console').innerHTML;var cookie=JsCookie.get(cookieName);if(cookie){try{options=Object.assign(options,JSON.parse(cookie));}catch(e){}}
this.log(this.getTextData(html));},};})();const JsUrl=(function(){const options=JsOptions('url').get({useRewrite:false,setLang:false,lang:'lang',go:'goto',format:'format',});function toQueryString(args){let arr=[];for(let name in args){arr.push(name+'='+encodeURIComponent(args[name]));}
return arr.join('&');}
let lang=options.setLang?document.querySelector('html').getAttribute('lang'):false;if(lang){lang=lang.replace('-','_');}
return function(route,args,format){route=route.split('/');args=Object.assign({},args);let access_point=route[0];let component=route[1]||'';let task=route[2]||'';let separator='?';let url;if(access_point=='front'){access_point='';}
if(options.useRewrite){url=[];if(lang){url.push(lang);}
if(access_point){url.push(access_point);}
if(component){url.push(component);}
if(task){url.push(task);}
url=url.join('/');}else{url='index.php';let go=[];let _args={};if(access_point){go.push(access_point);}
if(component){go.push(component);}
if(task){go.push(task);}
if(go.length){_args[options.go]=go.join('/');}
if(lang){_args[options.lang]=lang;}
if(Object.keys(_args).length){url+=separator+toQueryString(_args);separator='&';}}
if(format){args[options.format]=format;}
if(Object.keys(args).length){url+=separator+toQueryString(args);}
return url;};})();function JsTabs(tablist,options){options=Object.assign({},options);if(typeof options.onSelect!=='function'){options.onSelect=null;}
if(typeof tablist==='string'){tablist=document.querySelector(tablist);}
if(!(tablist instanceof Element)){return null;}
for(var tabpanel=tablist.nextSibling;tabpanel.nodeType!=1;tabpanel=tabpanel.nextSibling);function getChildNodes(el,tagName){let nodes=[];for(let i=0,L=el.childNodes.length;i<L;i++){if(el.childNodes[i].tagName==tagName){nodes.push(el.childNodes[i]);}}
return nodes;}
let handle,selected;let tabs=getChildNodes(tablist,'LI');let panels=getChildNodes(tabpanel,'DIV');let total=tabs.length;let lastTab=total-1;tabs.forEach(function(el,index){el.setAttribute('aria-setsize',total);el.setAttribute('aria-posinset',index+1);el.setAttribute('tabindex',0);el.addEventListener('click',function(event){event.preventDefault();that.select(index);});el.addEventListener('keydown',function(event){if(event.key==='Enter'){document.activeElement.click();}else if(event.key==='ArrowLeft'){that.prev();tabs[selected].focus();}else if(event.key==='ArrowRight'){that.next();tabs[selected].focus();}});});let that={select:function(index){if(typeof index!='number'||index>lastTab){index=0;}else if(index<0){index=lastTab;}
if(index!=selected){selected=index;let status;for(var i=0;i<total;i++){status=(i==index);tabs[i].setAttribute('aria-selected',status);tabs[i].setAttribute('tabindex',status?0:-1);tabs[i].className=panels[i].className=(status?'selected':'');if(options.onSelect){options.onSelect.call(that,i,status);}}
if(handle){clearTimeout(handle);}
handle=setTimeout(function(){panels[index].classList.add('active')},10);}
return this;},prev:function(){this.select(selected-1);},next:function(){this.select(selected+1);},selectedTabNumber:function(){return selected;},getContainer:function(number=-1){if(number<0){number=selected;}
return panels[number];},isEmpty:function(number,spinner=true){if(selected==number&&!panels[number].innerHTML){if(spinner){panels[number].innerHTML='<div class="box-loading"><i class="fa-solid fa-circle-notch fa-spin"></i></div>';}
return true;}
return false;},};return that;}
JsRequest.implement({xjs:function(options){return this.ajax(options,{format:'xjs',responseType:'json',update:false,onSuccess:(function(fn){return function(json){if(typeof json.data=='object'){if(json.data.__reloadPage){window.location.reload();}
if(typeof json.data.__redirectTo=='string'){window.location=new URL(json.data.__redirectTo,window.location.origin).href;}
if(json.data.__goBack){window.history.go(-1);}}
fn.call(options,json.message,json.code,json.data);}})(options.onSuccess),});},});