var ActiveHeader=function(el,css,top){if(typeof el=='string'){el=document.querySelector(el);}
css=css||'active';top=top||24;var status=false;function scrollTop(){return window.pageYOffset||document.documentElement.scrollTop;}
function fn(){if(status!=(scrollTop()>top)){status=el.classList.toggle(css);}}
fn();window.addEventListener('scroll',fn);};const JsTheme=function($btn){const storageName='prefers-color-scheme';const $icon=$btn.querySelector('i');const currentTheme=localStorage.getItem(storageName)||'auto';function set(theme,className,title){if(theme==='auto'){theme=window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches?'dark':'light';}
document.documentElement.setAttribute('data-theme',theme);$icon.className=className;$btn.setAttribute('title',title);$btn.setAttribute('aria-label',title);}
$btn.parentNode.querySelectorAll('[data-value]').forEach(function(el){const theme=el.getAttribute('data-value');const className=el.querySelector('i').className;const title=el.querySelector('span').textContent;if(currentTheme===theme){set(theme,className,title);}
el.addEventListener('click',function(){localStorage.setItem(storageName,theme);document.body.click();set(theme,className,title);});});};const Navbar=function(nav,btn,options){if(typeof nav=='string'){nav=document.querySelector(nav);}
if(typeof btn=='string'){btn=document.querySelector(btn);}
if(!nav||!btn){return;}
nav.toggle=function(value){if(value){this.classList.replace('navbar-mobile','navbar');}else{this.classList.replace('navbar','navbar-mobile');}};options=JsMergeOptions({},options);let curDisplay,displayValue,_nav;let parent=nav.parentNode;let sibling=nav.nextSibling;let body=document.body;let isOpen=0;let hasAccordion=nav.classList.contains('navbar-control');function Accordion(){let li=nav.querySelectorAll(':scope > ul > li');li.forEach(function(el,i){if(el.querySelector('ul')){let a=el.querySelector('a');a.href='javascript:void(0)';a.setAttribute('aria-expanded',el.classList.contains('expand'));a.addEventListener('keydown',function(event){if(event.key=='Enter'){minimizerFn(false);}});a.addEventListener('click',function(){if(options.fire('select',el)===false){return;}
li.forEach(function(el,j){let expanded=el.classList.contains('expand');let status=(i==j&&!expanded);if(expanded){if(!status){el.classList.remove('expand');}}else if(status){el.classList.add('expand');}
el.querySelector('a').setAttribute('aria-expanded',status);options.fire('change',el,status);});});}});}
let isInitialized=false;function initialize(){_nav=body.appendChild(JsElement('div.pull-navbar'));let _start,corrector;let _overlay=body.appendChild(JsElement('div.pull-overlay'));let _target=body.appendChild(JsElement('div.pull-target',{events:{click:function(){if(isOpen){_toggle();}}}}));function Escape(event){if(event.key=='Escape'){btn.click();}}
function _toggle(v){_nav.click();isOpen=body.classList.toggle('pull-on',v instanceof Event?undefined:v);if(isOpen){let a=_nav.querySelector('a');if(a){a.focus();}
document.addEventListener('keydown',Escape);}else{btn.focus();document.removeEventListener('keydown',Escape);}}
function _move(v){_nav.style.transition=['','initial'][v];_overlay.style.display=['','block'][v];}
JsMove(_target,function(event){let rect=event.target.getBoundingClientRect();_start={x:event.clientX,left:rect.left,right:(rect.left+rect.width),width:rect.width},corrector=_nav.getBoundingClientRect().width;_move(1);},function(event){let x=event.clientX,v=(_start.x-x);if(v<0){if(x<_start.right||x>corrector)return;x-=_start.width;}else if(v>0){if(x>_start.left)return;}else{return;}
_target.style.left=x+'px';_nav.style.transform='translateX('+(x-corrector)+'px)';},function(event){_target.style.left='';_nav.style.transform='';_move(0);_toggle((Math.abs(_start.left-event.clientX)>corrector/2)?!isOpen:isOpen);});if(btn){btn.addEventListener('click',_toggle);}
return true;}
function fn(){displayValue=window.getComputedStyle(btn).getPropertyValue('display');if(displayValue!==curDisplay){if(displayValue==='none'){if(isInitialized){parent.insertBefore(nav,sibling);}
nav.toggle(1);}else{if(!isInitialized){isInitialized=initialize();}
nav.toggle(0);_nav.appendChild(nav);}
if(hasAccordion){hasAccordion=false;Accordion();}
curDisplay=displayValue;body.classList.toggle('body-small',curDisplay!=='none');}}
let hash=nav.getAttribute('data-hash');if(hash){let el=nav.querySelector('[data-hash="'+hash+'"]');if(el){while(true){el=el.parentNode;if(el.tagName=='LI'){el.classList.add('selected');}else if(el==nav){break;}}}}
fn();window.addEventListener('resize',fn);let minimizer;function minimizerFn(force){if(force===undefined){force=JsCookie.get('BackendNavbar');}else{setCookie(force);}
body.classList.toggle('navbar-minimized',force);}
function setCookie(v){JsCookie.set('BackendNavbar',v?1:'');}
return{minimizer:function(slc){minimizer=document.querySelector(slc);minimizer.addEventListener('click',function(){setCookie(!body.classList.contains('navbar-minimized'));minimizerFn();});minimizerFn();}}};var Frontend=(function(){const controls=JsControls({tpl:{}});return{attach:function(name,fn){controls.attach('tpl',name,fn);},attachAll:function(obj){controls.attachAll('tpl',obj);},load:function(box){controls.load('tpl',box);}};})();Frontend.attachAll({logout:function(el){el.addEventListener('click',function(event){UsysLogout();});},theme:JsTheme,language:function($btn){$btn.parentNode.querySelectorAll('[data-value]').forEach(function(el){const lang=el.getAttribute('data-value');el.addEventListener('click',function(){JsRequest.xjs({url:JsUrl('language/change'),data:{lang},onSuccess:function(message,code){if(code){window.location.reload();}else{alert(message);}},});});});},notifications:function(el){el.addEventListener('click',function(event){Notifications();});},search:(function(){let box;return function(el){el.addEventListener('click',function(event){event.preventDefault();if(!box){box=document.body.appendChild(JsElement('DIV.tpl-search',{html:'<div><i class="fa-solid fa-xmark cursor-pointer"></i></div>'
+'<form class="box-default p-8" action="'+el.href+'" method="GET">'
+'<div class="input-group input-large">'
+'<input type="input" name="q" placeholder="" class="input-field input-primary">'
+'<button type="submit" class="btn btn-primary btn-solid"><i class="fa-solid fa-magnifying-glass"></i></button>'
+'</div>'
+'</form>'}));box.querySelector('div').addEventListener('click',function(){box.toggle();});box.toggle=function(){if(document.body.classList.toggle('search-fixed')){this.querySelector('input').focus();}};}
box.toggle();});};})(),});window.addEventListener('DOMContentLoaded',function(){Navbar('.navbar','header .pull-btn');ActiveHeader('body.fixed-header .tpl-header');Frontend.load(document);let h=document.body.querySelector('.tpl-header');if(h){JsFelem.load(h);}});window.addEventListener('load',function(){var el=document.querySelector('#cookieconsent');if(el){if(!JsCookie.get('cookieConsent')){el.classList.add('visible');document.querySelector('#cc-btn').addEventListener('click',function(){el.classList.remove('visible');JsCookie.set('cookieConsent',1);});}}});function UsysLogout(){JsDropdown.hide();JsRequest.modal({url:JsUrl('/usys/logout'),modalOptions:{onLoad:function(){JsForm('logout',{btn:this}).request(JsUrl('/usys/take_logout'),function(){window.location.reload();});}}});}
Notifications=(function(){return function(){JsRequest.text({url:JsUrl('my/notifications/show'),onSuccess:function(html){let el=document.querySelector('[control-tpl=notifications] span');if(el){el.parentNode.removeChild(el);}
Lightbox({valignCenter:false}).setContent(html);},})};})();